<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCP Practice</title>
    <meta name="description" content="Ëá™Â∑±Á∑¥ÁøíÁî®ÁöÑ!!!!!Á∑¥ÁøíÁúãÁúã~" />
</head>
<style>
    html{
        font-size: 16px;
        font-family: "Microsoft JhengHei";        
        text-align: center;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
    }
    
    body{
        width:100%;
        height: 100%;
        margin: 0 auto;
        line-height: 2rem;
        background-color: #74aec7;
        display: flex;
        align-items: center;
        justify-content: center;
        
    }

    #data{
        text-align: left;
        width: 100%;
    }
    #submit{
        margin: 10% auto;
        width: 150px;
        background-color: #F8FA9B;
        border: #838526 2px solid;
        border-radius: 60px;
        cursor: pointer;
    }

    .Wcontent{
        width:80%;
        max-width: 800px;
        background-color: #fff;
        padding: 2% 5%;
        border-radius: 60px;
        
    }

    #TotalQ{
        font-size: 2.4rem;
        color: #5FC3E0;
        font-weight: bold;
        padding: 5% 0 2% 0;
    }

    .EndWord{
        text-align: center !important;
        color: #FBA523;
        font-weight: bold;
        font-size: 2.2rem;
        padding-top: 10%;
        line-height: 3.2rem;
    }

    #result{
        margin: 8% auto 2% auto;
        font-size: 1.4rem;
    }
</style>
<body>
    <div class="Wcontent">
        <div id="TotalQ"></div>
        <div id="data"></div>
        <div id="result"></div>
        <div id='submit'>ÈÄÅÂá∫</div>
    </div>
    
    <script>
        let Qnum = 0;
        let Testdata;
        let totalNum=10;
        let userScore=0;

        async function fetchData() {
            try {
                const response = await fetch('data.json');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                Testdata = await response.json(); // Á¢∫‰øù Testdata Ë¢´Ë≥¶ÂÄº

                Testdata.sort(function(){return Math.random()>0.5?-1:1;});
                QuestionSet();
                
            } catch (error) {
                console.error('Fetch error:', error);
            }
        }

        fetchData(); 
        
        function QuestionSet(){
            document.getElementById('TotalQ').innerHTML=(Qnum+1)+' / '+totalNum;
            
            var opset = `
                    <label><input type="checkbox" name="answer" value="A" class="single-checkbox"> ${Testdata[Qnum].optionA}</label><br>
                    <label><input type="checkbox" name="answer" value="B" class="single-checkbox"> ${Testdata[Qnum].optionB}</label><br>
                    <label><input type="checkbox" name="answer" value="C" class="single-checkbox"> ${Testdata[Qnum].optionC}</label><br>
                    <label><input type="checkbox" name="answer" value="D" class="single-checkbox"> ${Testdata[Qnum].optionD}</label>
                `;

                if (Testdata[Qnum].type != 'single') {
                    opset = opset + `<br><label><input type="checkbox" name="answer" value="E" class="single-checkbox"> ${Testdata[Qnum].optionE}</label>`;
                }

                document.getElementById('data').innerHTML = `
                    <p>Q: ${Testdata[Qnum].Question}</p>
                    <div>${opset}</div>
                `;

                // ÈáçÊñ∞Á∂ÅÂÆö‰∫ã‰ª∂ÔºåÁ¢∫‰øùÊñ∞ÁöÑ checkbox ÊúÉÊúâÂñÆÈÅ∏Ë°åÁÇ∫
                document.querySelectorAll('.single-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        if (Testdata[Qnum].type == 'single') {
                            if (checkbox.checked) {
                                document.querySelectorAll('.single-checkbox').forEach(cb => {
                                    if (cb !== checkbox) cb.checked = false; // ÂÖ∂‰ªñÈÅ∏È†ÖËÆäÁÇ∫Êú™ÈÅ∏‰∏≠
                                });
                            }
                        }
                    });
                });
        }

        document.getElementById('submit').addEventListener('click', () => {
            console.log('Qnum=',Qnum)
            document.getElementById('result').innerHTML='';
            var selectedOptions = Array.from(document.querySelectorAll('input[name="answer"]:checked'))
                                         .map(option => option.value);

            if (selectedOptions.length > 0) {

                document.querySelectorAll('.single-checkbox').forEach(cb => {
                    cb.disabled = true; 
                });

                if(document.getElementById('submit').textContent=='ÈÄÅÂá∫'){
                    var result=selectedOptions;
                    var st='';
                    if(Testdata[Qnum].type != 'single'){
                        result = selectedOptions.join('„ÄÅ');
                    }

                    if(Testdata[Qnum].Answer==result){
                        st="<span style='color:#00C300; font-size:2rem;'>‚àö</span> "
                        userScore+=1;
                    }else{
                        st="<span style='color:#C42B1C; font-size:2rem;'>√ó</span> "
                    }      

                    document.getElementById('result').innerHTML += st+'Ëß£Á≠î:'+Testdata[Qnum].Answer;

                    if(Qnum>=totalNum-1){
                        document.getElementById('submit').innerHTML='ÁµêÊûú';
                    }else{
                        document.getElementById('submit').innerHTML='‰∏ã‰∏ÄÈ°å';
                    }
                }else if(document.getElementById('submit').textContent=='‰∏ã‰∏ÄÈ°å'){
                    Qnum+=1
                    QuestionSet()
                    document.getElementById('submit').innerHTML='ÈÄÅÂá∫';
                    document.getElementById('result').innerHTML='';
                    document.querySelectorAll('.single-checkbox').forEach(cb => {
                    cb.disabled = false; // ÂÖ∂‰ªñÈÅ∏È†ÖËÆäÁÇ∫Êú™ÈÅ∏‰∏≠
                });
                    
                }else if(document.getElementById('submit').textContent=='ÁµêÊûú'){
                    var wordtoU='';
                    if(userScore==totalNum){
                        wordtoU='ÁüÆÂî∑üòè!ÂÖ®Â∞çËÄ∂üíØ!ÁúüÁöÑÈÇÑÂÅáÁöÑÂï¶!Á©©ÈÅé‰∫ÜÂï¶üòÄüòÄüòÄüòÄüòÄ!!';
                    }else if(userScore>=totalNum*0.8 && userScore!=totalNum){
                        wordtoU='ÂèØ‰ª•Âï¶!ÈÄöÈÅé‰∫ÜÂï¶ÈÅé‰∫ÜÂï¶~üòéüòéüòé';
                    }else if(userScore>=totalNum*0.7 && userScore<=80){
                        wordtoU='Âî∑~Â∞èÂøÉÂñî~Âç±Èö™ÈÇäÁ∑£~üòàü§úü§õüòâ';
                    }else{
                        wordtoU='ÂÆåËõã‰∫Ü‰Ω†!!3000Â§öÈ£õ‰∫Ü!ü•¥ü§Øüíîüí∏';
                    }


                    
                    document.getElementById('TotalQ').innerHTML='Á≠îÂ∞çÈ°åÊï∏:'+userScore;
                    document.getElementById('data').innerHTML=wordtoU;
                    document.getElementById('data').classList.add("EndWord");
                    document.getElementById('submit').innerHTML='ÊàëË¶ÅÈáçÊ∏¨Âï¶!';
                    document.getElementById('result').innerHTML='';
                }

            }else if(Qnum+1>=totalNum){
                location.reload() ;
            } 
            else {
                document.getElementById('result').innerHTML='<span style="color:red;">‰Ω†ÊúâÈÅ∏ÊìáÁ≠îÊ°àÂóé??????</span>';
            }
        });

    </script>
</body>
</html>
